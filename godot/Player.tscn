[gd_scene load_steps=12 format=2]

[ext_resource path="res://Player.gd" type="Script" id=1]
[ext_resource path="res://assets/100x100_RedCircle.png" type="Texture" id=2]

[sub_resource type="GDScript" id=1]
script/source = "extends Node2D

onready var anim = get_node(\"AnimationPlayer\")
onready var sprite = get_node(\"Player\")

onready var rc_down = get_node(\"RayCastDown\")
onready var rc_up = get_node(\"RayCastUp\")
onready var rc_left = get_node(\"RayCastLeft\")
onready var rc_right = get_node(\"RayCastRight\")
signal health_changed();
var health = 100;

func _ready():
	set_process_input(true)

func _input(event):
	if not anim.is_playing():
		if event.is_action_pressed(\"ui_down\"):
			if rc_down.is_colliding():
				anim.play(\"look_down\")
			else:
				anim.play(\"down\")
				move_squares(Vector2(0,1))
		if event.is_action_pressed(\"ui_up\"):
			if rc_up.is_colliding():
				anim.play(\"look_up\")
			else:
				anim.play(\"up\")
				move_squares(Vector2(0,-1))
		if event.is_action_pressed(\"ui_left\"):
			if rc_left.is_colliding():
				anim.play(\"look_left\")
			else:
				anim.play(\"left\")
				move_squares(Vector2(-1,0))
		if event.is_action_pressed(\"ui_right\"):
			if rc_right.is_colliding():
				anim.play(\"look_right\")
			else:
				anim.play(\"right\")
				move_squares(Vector2(1,0))
	

func move_squares(offset):
	translate(offset * 16)"

[sub_resource type="Animation" id=2]
length = 0.001

[sub_resource type="Animation" id=3]
length = 0.001

[sub_resource type="Animation" id=4]
length = 0.001

[sub_resource type="Animation" id=5]
length = 0.001

[sub_resource type="Animation" id=6]
length = 0.001

[sub_resource type="Animation" id=7]
length = 0.001

[sub_resource type="Animation" id=8]
length = 0.001

[sub_resource type="Animation" id=9]
length = 0.001

[node name="TemplatePlayer" type="Node2D"]
script = ExtResource( 1 )

[node name="KinematicBody2D" type="KinematicBody2D" parent="."]
z_index = 2
collision/safe_margin = 0.001
script = SubResource( 1 )

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="KinematicBody2D"]
polygon = PoolVector2Array( -8, -8, 8, -8, 8, 8, -8, 8 )

[node name="Player" type="Sprite" parent="KinematicBody2D"]
z_index = 2
z_as_relative = false
texture = ExtResource( 2 )
region_enabled = true
region_rect = Rect2( 80, 208, 16, 16 )
region_filter_clip = true

[node name="AnimationPlayer" type="AnimationPlayer" parent="KinematicBody2D"]
anims/down = SubResource( 2 )
anims/left = SubResource( 3 )
anims/look_down = SubResource( 4 )
anims/look_left = SubResource( 5 )
anims/look_right = SubResource( 6 )
anims/look_up = SubResource( 7 )
anims/right = SubResource( 8 )
anims/up = SubResource( 9 )

[node name="RayCastDown" type="RayCast2D" parent="KinematicBody2D"]
enabled = true
cast_to = Vector2( 0, 16 )

[node name="RayCastUp" type="RayCast2D" parent="KinematicBody2D"]
enabled = true
cast_to = Vector2( 0, -16 )

[node name="RayCastLeft" type="RayCast2D" parent="KinematicBody2D"]
enabled = true
cast_to = Vector2( -16, 0 )

[node name="RayCastRight" type="RayCast2D" parent="KinematicBody2D"]
enabled = true
cast_to = Vector2( 16, 0 )

[node name="RayCastLOS" type="RayCast2D" parent="KinematicBody2D"]
enabled = true

